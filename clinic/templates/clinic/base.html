{% load static %}
<!DOCTYPE html>
<html lang="sq">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>
            {% block title %}Clinic DB{% endblock %}
        </title>
        <!-- Tailwind -->
        <script src="https://cdn.tailwindcss.com"></script>
        <!-- Phosphor Icons -->
        <script src="https://unpkg.com/@phosphor-icons/web"></script>
        <!-- Static files -->
        {% load static %}
        <style>body { font-family: 'Inter', sans-serif; }</style>
    </head>
    <body class="bg-gray-50 text-gray-900">
        {% with name=request.resolver_match.url_name %}
            <div class="min-h-screen flex">
                <!-- SIDEBAR -->
                <aside id="sidebar"
                       class="fixed inset-y-0 left-0 z-40 w-72 bg-white border-r shadow-sm transform -translate-x-full transition-transform duration-300 md:translate-x-0 md:flex md:flex-col">
                    <!-- Logo -->
                    <div class="flex items-center justify-center px-5 py-4 border-b">
                        <a href="{% url 'home' %}" class="flex items-center gap-3">
                            <img src="{% static 'assets/img/logo.svg' %}"
                                 alt="Clinic Logo"
                                 class="h-16 w-auto">
                        </a>
                    </div>
                    <!-- Nav -->
                    <nav class="flex-1 overflow-y-auto px-4 py-6 space-y-6 text-sm">
                        <!-- Pacientët -->
                        <div>
                            <div class="px-3 mb-2 text-xs font-semibold text-gray-400 uppercase">Pacientët</div>
                            <ul class="space-y-1">
                                <li>
                                    <a href="{% url 'patient_list' %}"
                                       class="flex items-center gap-3 px-3 py-2 rounded-lg transition {% if name == 'patient_list' or name == 'patient_detail' %} bg-gray-100 text-gray-900 font-medium {% else %} text-gray-600 hover:bg-gray-50 {% endif %}">
                                        <i class="ph ph-users text-lg"></i>
                                        Të gjithë pacientët
                                    </a>
                                </li>
                                <li>
                                    <a href="{% url 'orto_patient_list' %}"
                                       class="flex items-center gap-3 px-3 py-2 rounded-lg transition {% if name == 'orto_patient_list' or name == 'orto_patient_detail' %} bg-gray-100 text-gray-900 font-medium {% else %} text-gray-600 hover:bg-gray-50 {% endif %}">
                                        <i class="ph ph-tooth text-lg"></i>
                                        Pacientët Orto
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <!-- Financa & Raporte -->
                        <div>
                            <div class="px-3 mb-2 text-xs font-semibold text-gray-400 uppercase">Financa & Raporte</div>
                            <ul class="space-y-1">
                                <li>
                                    <a href="{% url 'checkout' %}"
                                       class="flex items-center gap-3 px-3 py-2 rounded-lg transition {% if name == 'checkout' %} bg-gray-100 text-gray-900 font-medium {% else %} text-gray-600 hover:bg-gray-50 {% endif %}">
                                        <i class="ph ph-credit-card text-lg"></i>
                                        Pagesat
                                    </a>
                                </li>
                                <li>
                                    <a href="{% url 'reports_new' %}"
                                       class="flex items-center gap-3 px-3 py-2 rounded-lg transition {% if name == 'reports_new' %} bg-gray-100 text-gray-900 font-medium {% else %} text-gray-600 hover:bg-gray-50 {% endif %}">
                                        <i class="ph ph-chart-bar text-lg"></i>
                                        Raportet
                                    </a>
                                </li>
                                <li>
                                    <a href="{% url 'reports' %}"
                                       class="flex items-center gap-3 px-3 py-2 rounded-lg transition {% if name == 'reports' %} bg-gray-100 text-gray-900 font-medium {% else %} text-gray-600 hover:bg-gray-50 {% endif %}">
                                        <i class="ph ph-archive text-lg"></i>
                                        Raportet (Arkiva)
                                    </a>
                                </li>
                                <li>
                                    <a href="{% url 'shpenzime_list' %}"
                                       class="flex items-center gap-3 px-3 py-2 rounded-lg transition {% if name == 'shpenzime_list' or name == 'shpenzime_detail' %} bg-gray-100 text-gray-900 font-medium {% else %} text-gray-600 hover:bg-gray-50 {% endif %}">
                                        <i class="ph ph-receipt text-lg"></i>
                                        Shpenzimet
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <!-- Sistemi -->
                        <div>
                            {% if request.user.is_authenticated and request.user.role == "admin" %}
                                <div class="px-3 mb-2 text-xs font-semibold text-gray-400 uppercase">Sistemi</div>
                                <ul class="space-y-1">
                                    <li>
                                        <a href="/admin/"
                                           class="flex items-center gap-3 px-3 py-2 rounded-lg transition text-gray-600 hover:bg-gray-50">
                                            <i class="ph ph-shield-check text-lg"></i>
                                            Admin
                                        </a>
                                    </li>
                                {% endif %}
                            </ul>
                        </div>
                    </nav>
                    <!-- Footer -->
                    <div class="px-6 py-4 border-t flex items-center justify-between">
                        <span class="text-xs text-gray-400">© {{ now|date:"Y" }} Dr.Labi</span>
                        {% if request.user.is_authenticated %}
                            <div>
                                <ul class="space-y-1">
                                    <li>
                                        <form action="{% url 'logout' %}" method="post" class="m-0">
                                            {% csrf_token %}
                                            <button type="submit"
                                                    class="w-full flex items-center gap-2 px-2 py-1.5 rounded-md text-sm text-gray-500 hover:bg-red-50 hover:text-red-600 transition">
                                                <i class="ph ph-sign-out text-base"></i>
                                                Dil
                                            </button>
                                        </form>
                                    </li>
                                </ul>
                            </div>
                        {% endif %}
                    </div>
                </aside>
                <!-- Overlay (mobile) -->
                <div id="overlay"
                     class="fixed inset-0 bg-black/40 z-30 hidden md:hidden"
                     onclick="toggleSidebar()"></div>
                <!-- Content -->
                <div class="flex-1 min-w-0 md:ml-72">
                    <!-- Topbar (mobile) -->
                    <div class="md:hidden bg-white border-b h-14 flex items-center justify-between px-4 shadow-sm">
                        <button class="p-2" onclick="toggleSidebar()">
                            <i class="ph ph-list text-xl"></i>
                        </button>
                        <a href="{% url 'home' %}" class="font-semibold">Dr.Labi</a>
                        <div class="w-6 h-6"></div>
                    </div>
                    <!-- MAIN -->
                    <main class="p-6">
                        {% block content %}{% endblock %}
                    </main>
                </div>
            </div>
        {% endwith %}
        <script>
  function toggleSidebar(){
    const sb = document.getElementById('sidebar');
    const ov = document.getElementById('overlay');
    const isOpen = !sb.classList.contains('-translate-x-full');

    if(isOpen){
      sb.classList.add('-translate-x-full');
      ov.classList.add('hidden');
    }else{
      sb.classList.remove('-translate-x-full');
      ov.classList.remove('hidden');
    }
  }
        </script>
    </body>
</html>
